<!doctype html>
<html lang="es">

{{> header}}

<div class="container my-5">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h1 class="h4 m-0">{{formTitle}}</h1>
    <a class="btn btn-outline-primary" href="/brand/{{brandId}}">Cancelar</a>
  </div>

  {{#hasErrors}}
  <div class="alert alert-danger alert-dismissible fade show" role="alert">
    <strong>Errores de validación:</strong>
    <ul class="mb-0 mt-2">
      {{#errors}}
      <li>{{.}}</li>
      {{/errors}}
    </ul>
    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Cerrar"></button>
  </div>
  {{/hasErrors}}

  <form class="row g-3" action="{{formAction}}" method="POST" enctype="multipart/form-data" novalidate>

    <!-- Model name -->
    <div class="col-12 col-md-6">
      <label for="modelName" class="form-label">Nombre del modelo <span class="text-danger">*</span></label>
      <input type="text" id="modelName" name="name" class="form-control" placeholder="Ej. Air Zoom"
        value="{{model.name}}" required>
      <div class="invalid-feedback d-none"></div>
    </div>

    <!-- Category -->
    <div class="col-12 col-md-6">
      <label for="category" class="form-label">Categoría <span class="text-danger">*</span></label>
      <select id="category" name="category" class="form-select" required>
        <option value="">Selecciona...</option>
        <option value="Running" {{#categories_Running}}selected{{/categories_Running}}>Running</option>
        <option value="Lifestyle" {{#categories_Lifestyle}}selected{{/categories_Lifestyle}}>Lifestyle</option>
        <option value="Basketball" {{#categories_Basketball}}selected{{/categories_Basketball}}>Basketball</option>
        <option value="Skate" {{#categories_Skate}}selected{{/categories_Skate}}>Skate</option>
        <option value="Tenis" {{#categories_Tenis}}selected{{/categories_Tenis}}>Tenis</option>
        <option value="Football" {{#categories_Football}}selected{{/categories_Football}}>Football</option>
        <option value="Training" {{#categories_Training}}selected{{/categories_Training}}>Training</option>
      </select>
      <div class="invalid-feedback d-none"></div>
    </div>

    <!-- Description -->
    <div class="col-12">
      <label for="description" class="form-label">Descripción <span class="text-danger">*</span></label>
      <textarea id="description" name="description" class="form-control" rows="3"
        placeholder="Breve descripción del modelo (10-500 caracteres)" required>{{model.description}}</textarea>
      <small class="form-text text-muted">Debe tener entre 10 y 500 caracteres</small>
      <div class="invalid-feedback d-none"></div>
    </div>

    <!-- Release Year -->
    <div class="col-6 col-md-4">
      <label for="releaseYear" class="form-label">Año de lanzamiento <span class="text-danger">*</span></label>
      <input type="number" id="releaseYear" name="release_year" class="form-control" min="1970" max="2025" step="1"
        value="{{model.release_year}}" required>
      <div class="invalid-feedback d-none"></div>
    </div>

    <!-- Prize -->
    <div class="col-6 col-md-4">
      <label for="price" class="form-label">Precio (€) <span class="text-danger">*</span></label>
      <input type="number" id="price" name="price" class="form-control" min="0" step="0.01" value="{{model.price}}"
        required>
      <div class="invalid-feedback d-none"></div>
    </div>

    <!-- Average rating -->
    <div class="col-12 col-md-4">
      <label for="rating" class="form-label">Valoración media</label>
      <input type="number" id="rating" name="average_rating" class="form-control" min="0" max="5" step="0.1"
        value="{{model.average_rating}}">
      <small class="form-text text-muted">Valores entre 0 y 5</small>
      <div class="invalid-feedback d-none"></div>
    </div>

    <!-- Colorway -->
    <div class="col-12 col-md-6">
      <label for="colorway" class="form-label">Colorway</label>
      <input type="text" id="colorway" name="colorway" class="form-control" placeholder="Black/White"
        value="{{model.colorway}}">
    </div>

    <!-- Size -->
    <div class="col-12 col-md-6">
      <label for="sizeRange" class="form-label">Tallas (EU)</label>
      <input type="text" id="sizeRange" name="size_range" class="form-control" placeholder="40-45"
        value="{{model.size_range}}">
    </div>

    <!-- Image -->
<div class="col-12">
  <label for="coverImage" class="form-label">Imagen principal</label>

  <div id="modelImageDropzone" class="border rounded p-3 mb-2 text-center" style="cursor:pointer;">
    Arrastra y suelta una imagen aquí o haz clic para seleccionarla
  </div>

  <input type="file" id="coverImage" name="cover_image" class="form-control" accept="image/*">

  <div class="mt-3 d-flex align-items-center gap-3 flex-wrap">
    <img id="modelImagePreview" class="d-none rounded border" alt="Previsualización" style="max-height: 120px;">
    <button id="btnRemoveSelectedModelImage" class="btn btn-outline-secondary btn-sm" type="button">
      Quitar imagen seleccionada
    </button>
  </div>

  {{#model.imageFilename}}
  <p class="form-text mt-2 mb-1">
    <small>Imagen actual: {{model.imageFilename}}</small>
  </p>

  <div class="form-check">
    <input class="form-check-input" type="checkbox" value="true" id="removeModelImage" name="remove_image">
    <label class="form-check-label" for="removeModelImage">
      Eliminar imagen actual (si no subes una nueva)
    </label>
  </div>
  {{/model.imageFilename}}
</div>


    <!-- Buttons -->
    <div class="col-12">
      <button class="btn btn-primary" type="submit">Guardar</button>
      <a class="btn btn-outline-secondary" href="/brand/{{brandId}}">Cancelar</a>
    </div>
  </form>
</div>

{{> footer}}

<script src="/app.js"></script>