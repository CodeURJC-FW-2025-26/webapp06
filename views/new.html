<!doctype html>
<html lang="es">

{{> header}}

<div class="container my-5">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h1 class="h4 m-0">{{formTitle}}</h1>
    <a class="btn btn-outline-primary" href="/index">Cancelar</a>
  </div>

  {{#hasErrors}}
  <div class="alert alert-danger alert-dismissible fade show" role="alert">
    <strong>Errores de validación:</strong>
    <ul class="mb-0 mt-2">
      {{#errors}}
      <li>{{.}}</li>
      {{/errors}}
    </ul>
    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Cerrar"></button>
  </div>
  {{/hasErrors}}

  <form class="row g-3" action="{{formAction}}" method="POST" enctype="multipart/form-data" novalidate>
    <!-- Brand name -->
    <div class="col-12 col-md-6">
      <label for="brandName" class="form-label">Nombre de la marca <span class="text-danger">*</span></label>
      <input type="text" id="brandName" name="name" class="form-control" placeholder="Ej. Nike" value="{{brand.name}}"
        required>
      <div class="invalid-feedback d-none"></div>
    </div>

    <!-- Country of origin -->
    <div class="col-12 col-md-6">
      <label for="country" class="form-label">País de origen <span class="text-danger">*</span></label>
      <input type="text" id="country" name="country_origin" class="form-control" placeholder="Ej. Estados Unidos"
        value="{{brand.country_origin}}" required>
      <div class="invalid-feedback d-none"></div>
    </div>

    <!-- Founding date -->
    <div class="col-12 col-md-6">
      <label for="founded" class="form-label">Año de fundación <span class="text-danger">*</span></label>
      <input type="number" id="founded" name="founded_year" class="form-control" min="1900" max="2025" step="1"
        value="{{brand.founded_year}}" required>
      <div class="invalid-feedback d-none"></div>
    </div>

    <!-- Description -->
    <div class="col-12">
      <label for="description" class="form-label">Descripción <span class="text-danger">*</span></label>
      <textarea id="description" name="description" class="form-control" rows="3"
        placeholder="Breve historia y estilo de la marca (20-300 caracteres)" required>{{brand.description}}</textarea>
      <small class="form-text text-muted">Debe tener entre 20 y 300 caracteres</small>
      <div class="invalid-feedback d-none"></div>
    </div>

    <!-- Logo / Image -->
    <div class="col-12">
    <label for="logo" class="form-label">Logo / Imagen</label>

    <div id="brandImageDropzone" class="border rounded p-3 mb-2 text-center" style="cursor:pointer;">
      Arrastra y suelta una imagen aquí o haz clic para seleccionarla
    </div>

    <input type="file" id="logo" name="brand_image" class="form-control" accept="image/*">

    <div class="mt-3 d-flex align-items-center gap-3 flex-wrap">
      <img id="brandImagePreview" class="d-none rounded border" alt="Previsualización" style="max-height: 120px;">
      <button id="btnRemoveSelectedImage" class="btn btn-outline-secondary btn-sm" type="button">
        Quitar imagen seleccionada
      </button>
    </div>

    {{#brand.imageFilename}}
    <p class="form-text mt-2 mb-1">
      <small>Imagen actual: {{brand.imageFilename}}</small>
    </p>

    <div class="form-check">
      <input class="form-check-input" type="checkbox" value="true" id="removeImage" name="remove_image">
      <label class="form-check-label" for="removeImage">
        Eliminar imagen actual (si no subes una nueva)
      </label>
    </div>
    {{/brand.imageFilename}}
</div>


    <!-- Buttons -->
    <div class="col-12">
      <button class="btn btn-primary" type="submit">Guardar</button>
      <a class="btn btn-outline-secondary" href="/index">Cancelar</a>
    </div>
  </form>
</div>

{{> footer}}

<script src="/app.js"></script>